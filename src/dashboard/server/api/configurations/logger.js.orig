const config = require('config')
const logger = require('koa-pino-logger')

/**
 * @param {import('koa')} app
 */
module.exports = (app) => {
  const level = {
    test: 'silent',
    development: 'debug',
    production: 'info'
  }[app.env]
  const prettyPrint = app.env === 'development'
<<<<<<< HEAD
  const level = 'warn'
  const middleware = logger({ prettyPrint, level })
=======
  const middleware = logger({ level, prettyPrint })
  app.silent = app.env === 'test'
>>>>>>> c52a2da5411eb8408c7ce099ef8b64f0558cb564

  // Log the config
  middleware.logger.info(config.util.toObject(), 'App config')

  app.use(middleware)
}
