<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>依瞳人工智能开发平台</title>
    <meta name="generator" content="VuePress 1.5.3">
    
    <meta name="description" content="">
    <link rel="preload" href="/docs/zh/handbook/assets/css/0.styles.802763f5.css" as="style"><link rel="preload" href="/docs/zh/handbook/assets/js/app.6d750477.js" as="script"><link rel="preload" href="/docs/zh/handbook/assets/js/2.bf00e7ab.js" as="script"><link rel="preload" href="/docs/zh/handbook/assets/js/8.cf244a99.js" as="script"><link rel="prefetch" href="/docs/zh/handbook/assets/js/10.cca9f230.js"><link rel="prefetch" href="/docs/zh/handbook/assets/js/11.501b21a8.js"><link rel="prefetch" href="/docs/zh/handbook/assets/js/12.51873596.js"><link rel="prefetch" href="/docs/zh/handbook/assets/js/13.08622c4b.js"><link rel="prefetch" href="/docs/zh/handbook/assets/js/3.ba0c395a.js"><link rel="prefetch" href="/docs/zh/handbook/assets/js/4.dbe57fa8.js"><link rel="prefetch" href="/docs/zh/handbook/assets/js/5.0ba95d70.js"><link rel="prefetch" href="/docs/zh/handbook/assets/js/6.9db35a50.js"><link rel="prefetch" href="/docs/zh/handbook/assets/js/7.c6a035bc.js"><link rel="prefetch" href="/docs/zh/handbook/assets/js/9.a478451c.js">
    <link rel="stylesheet" href="/docs/zh/handbook/assets/css/0.styles.802763f5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-navbar"><!----> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/docs/zh/handbook/" aria-current="page" class="sidebar-link">1 产品简介</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/zh/handbook/#_1-1-产品概述" class="sidebar-link">1.1 产品概述</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/#_1-2-名词解释" class="sidebar-link">1.2 名词解释</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/#_1-3-功能介绍" class="sidebar-link">1.3 功能介绍</a></li></ul></li><li><section class="sidebar-group depth-0"><a href="/docs/zh/handbook/注册和登录" class="sidebar-heading clickable open"><span>2 操作说明</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/zh/handbook/注册和登录.html" class="sidebar-link">2.1 注册和登录</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/zh/handbook/注册和登录.html#_2-1-1-账号密码注册登录" class="sidebar-link">2.1.1 账号密码注册登录</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/注册和登录.html#_2-1-2-微信注册登录" class="sidebar-link">2.1.2 微信注册登录</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/注册和登录.html#_2-1-3-微软邮箱注册登录" class="sidebar-link">2.1.3 微软邮箱注册登录</a></li></ul></li><li><a href="/docs/zh/handbook/平台主页.html" class="sidebar-link">2.2 平台主页</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/zh/handbook/平台主页.html#_2-2-1-菜单栏" class="sidebar-link">2.2.1 菜单栏</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/平台主页.html#_2-2-2-主页图表" class="sidebar-link">2.2.2 主页图表</a></li></ul></li><li><a href="/docs/zh/handbook/提交训练任务.html" class="sidebar-link">2.3 Submit Training Job</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/zh/handbook/提交训练任务.html#_2-3-1-基本设置" class="sidebar-link">2.3.1 基本设置</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/提交训练任务.html#_2-3-2-高级配置" class="sidebar-link">2.3.2 高级配置</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/提交训练任务.html#_2-3-3-模板设置" class="sidebar-link">2.3.3 模板设置</a></li></ul></li><li><a href="/docs/zh/handbook/查看管理任务.html" class="sidebar-link">2.4 View and Manage Jobs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/zh/handbook/查看管理任务.html#_2-4-1-job-列表" class="sidebar-link">2.4.1 Job 列表</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/查看管理任务.html#_2-4-2-job详情" class="sidebar-link">2.4.2 job详情</a></li></ul></li><li><a href="/docs/zh/handbook/集群状态.html" class="sidebar-link">2.5 Cluster Status</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/zh/handbook/集群状态.html#_2-5-1-team-virtual-cluster-status" class="sidebar-link">2.5.1 Team Virtual Cluster Status</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/集群状态.html#_2-5-2-team-vc-user-status" class="sidebar-link">2.5.2 Team VC User Status</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/集群状态.html#_2-5-3-cluster-usage" class="sidebar-link">2.5.3 Cluster Usage</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/集群状态.html#_2-5-4-physical-cluster-node-status" class="sidebar-link">2.5.4 Physical Cluster Node Status</a></li></ul></li><li><a href="/docs/zh/handbook/虚拟集群.html" class="sidebar-link">2.6 Visual Cluster</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/zh/handbook/虚拟集群.html#_2-6-1-vc列表" class="sidebar-link">2.6.1   VC列表</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/虚拟集群.html#_2-6-2-新增vc" class="sidebar-link">2.6.2   新增VC</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/虚拟集群.html#_2-6-3-修改vc" class="sidebar-link">2.6.3   修改VC</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/虚拟集群.html#_2-6-4-删除vc" class="sidebar-link">2.6.4   删除VC</a></li></ul></li><li><a href="/docs/zh/handbook/用户仪表盘.html" class="sidebar-link">2.7 user Dashboard</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/zh/handbook/用户仪表盘.html#_2-7-1-顶端菜单栏" class="sidebar-link">2.7.1 顶端菜单栏</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/用户仪表盘.html#_2-7-2-dashboard" class="sidebar-link">2.7.2 Dashboard</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/用户仪表盘.html#_2-7-3-user" class="sidebar-link">2.7.3 User</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/zh/handbook/用户仪表盘.html#_2-7-3-1-用户列表" class="sidebar-link">2.7.3.1 用户列表</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/用户仪表盘.html#_2-7-3-2-新建用户" class="sidebar-link">2.7.3.2 新建用户</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/用户仪表盘.html#_2-7-4-group" class="sidebar-link">2.7.4 Group</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/zh/handbook/用户仪表盘.html#_2-7-4-1-用户组列表" class="sidebar-link">2.7.4.1 用户组列表</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/用户仪表盘.html#_2-7-4-2-新建用户组" class="sidebar-link">2.7.4.2 新建用户组</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/用户仪表盘.html#_2-7-5-role" class="sidebar-link">2.7.5 Role</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/zh/handbook/用户仪表盘.html#_2-7-5-1-角色列表" class="sidebar-link">2.7.5.1 角色列表</a></li></ul></li></ul></li><li><a href="/docs/zh/handbook/报警配置.html" class="active sidebar-link">2.8 报警配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/zh/handbook/报警配置.html#_2-8-1-config-yaml" class="sidebar-link">2.8.1 config.yaml</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/报警配置.html#_2-8-2-ecc-config-yaml" class="sidebar-link">2.8.2 ecc-config.yaml</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/报警配置.html#_2-8-3-rule-alerts-yaml" class="sidebar-link">2.8.3 rule-alerts.yaml</a></li><li class="sidebar-sub-header"><a href="/docs/zh/handbook/报警配置.html#_2-8-4-rule-config-yaml" class="sidebar-link">2.8.4 rule config.yaml</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>平台暂无可视化的报警配置页面（后续会增加），可通过修改配置文件后重新部署repairmanager2服务，来使相关报警配置参数生效。修改报警参数后，需执行的命令如下：</p> <p>重新编译repairmanager2服务，如有x86架构的机器，需在x86机器上添加参数--arch amd64执行，如有arm架构的机器，需在arm机器上添加参数--arm arm64执行：</p> <p>重新编译：</p> <p>#sudo ./deploy.py --verbose --arch amd64 docker push repairmanager2</p> <p>重启repairmanager2服务：</p> <p>#sudo ./deploy.py kubernetes stop repairmanager2</p> <p>#sudo ./deploy.py kubernetes start repairmanager2</p> <p>报警参数相关的配置文件共4个，分别为：</p> <p>apulis_platform/src/ClusterBootstrap/config.yaml，配置发件人和收件人的信息、报警标题中的集群名称；</p> <p>apulis_platform/src/RepairManager/config/ecc-config.yaml，配置监控指标的阈值表达式、查询间隔、查询时间段、阈值百分比；</p> <p>apulis_platform/src/RepairManager/config/rule-alerts.yaml，配置是否启用报警、是否重复报警和重复报警的时间间隔；</p> <p>apulis_platform/src/RepairManager/config/rule-config.yaml，配置查询的时间间隔。</p> <p>目前监测的报警指标共4个，分别为nvidiasmi_ecc_error_count、cpu utilization、memory utilization和filesystem left space。</p> <h2 id="_2-8-1-config-yaml"><a href="#_2-8-1-config-yaml" class="header-anchor">#</a> 2.8.1 config.yaml</h2> <p>cluster_name：配置报警邮件标题中的集群名称。</p> <p>smtp_url：配置smtp服务器地址。</p> <p>login和sender：配置发件人的邮箱。</p> <p>password：配置发件人邮箱的密码。</p> <p>receiver：配置收件人邮箱，可配置多个。</p> <p><img src="/docs/zh/handbookassets/img/image-20200820100119471.02031e4f.png" alt="image-20200820100119471"></p> <p>​                                                                                                图 48 config.yaml配置</p> <h2 id="_2-8-2-ecc-config-yaml"><a href="#_2-8-2-ecc-config-yaml" class="header-anchor">#</a> 2.8.2 ecc-config.yaml</h2> <p>query_expression：配置监控指标的阈值表达式，当监控指标的值达到该条件时记录一次报警；</p> <p>step：配置查询间隔，单位为分钟，假设该值设置为N，则表示每隔N分钟去查询一次监控指标的值；</p> <p>interval：配置查询的时间段，单位为分钟，假设该值设置为M，则表示在过去的M分钟内，每隔N分钟去查询一次监控指标；</p> <p>percent_threshold：配置阈值百分比，在监控时间内，报警次数占比大于该值即触发报警，发送报警邮件；</p> <p>name：配置报警时的邮件标题。</p> <p>综合各参数的设置，在过去的interval时间段内，每隔step分钟去查询一次，即查询总次数为interval/step（向下取整），设为P；在监控的总次数内，监测值达到阈值表达式时的次数为Q，则报警占比为Q/P；如Q/P<em>100大于阈值百分比percent_threshold，则触发报警，如Q/P</em>100小于阈值百分比percent_threshold，则不触发报警。</p> <p><img src="/docs/zh/handbookassets/img/image-20200820100244688.4defbb46.png" alt="image-20200820100244688"></p> <p>​                                                                                                    图 49 ecc-config.yaml</p> <h2 id="_2-8-3-rule-alerts-yaml"><a href="#_2-8-3-rule-alerts-yaml" class="header-anchor">#</a> 2.8.3 rule-alerts.yaml</h2> <p>alerts_enabled：配置是否发送邮件，设置为True，则发送报警邮件，设置为False，则不发送报警邮件；</p> <p>reminders_enabled：配置是否重复发送报警邮件，设置为True，则会重复发送报警邮件，设置为False，则只有第一次报警时才发送报警邮件；</p> <p>reminder_wait_time：配置重新发送报警邮件的时间间隔，如reminders_enabled设置为True，两次报警时间间隔大于reminder_wait_time则会再次发送报警邮件，如时间间隔小于reminder_wait_time则不会重复发送报警邮件。</p> <p><img src="/docs/zh/handbookassets/img/image-20200820100409802.e4a32b25.png" alt="image-20200820100409802"></p> <p>​                                                                                                   图 50 rule-alerts.yaml</p> <h2 id="_2-8-4-rule-config-yaml"><a href="#_2-8-4-rule-config-yaml" class="header-anchor">#</a> 2.8.4 rule config.yaml</h2> <p>rule_wait_time：设置查询间隔，单位为秒，该参数设置为N，即与上次查询各指标的时间间隔为N秒。</p> <p><img src="/docs/zh/handbookassets/img/image-20200820100535544.94a3fde2.png" alt="image-20200820100535544"></p> <p>​                                                                                                    图51 rule-config.yaml</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/zh/handbook/用户仪表盘.html" class="prev">
        2.7 user Dashboard
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/docs/zh/handbook/assets/js/app.6d750477.js" defer></script><script src="/docs/zh/handbook/assets/js/2.bf00e7ab.js" defer></script><script src="/docs/zh/handbook/assets/js/8.cf244a99.js" defer></script>
  </body>
</html>
